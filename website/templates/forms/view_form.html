{% extends 'base.html' %}

{% block title %}View Form #{{ form_submission.form_id }} - Form Management System{% endblock %}

{% block content %}
<div class="container" style="margin-top: 2rem; margin-bottom: 2rem;">
    <div style="max-width: 800px; margin: 0 auto;">
        <div style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
            
            <div style="text-align: center; margin-bottom: 2rem;">
                <i class="fas fa-file-alt" style="font-size: 3rem; color: #667eea; margin-bottom: 1rem;"></i>
                <h1 style="margin-bottom: 0.5rem;">Form #{{ form_submission.form_id }}</h1>
                <div style="margin-bottom: 1rem;">
                    <span class="status-badge status-{{ form_submission.status }}">
                        {{ form_submission.get_status_display }}
                    </span>
                </div>
                <p style="color: #666;">Submitted on {{ form_submission.submission_date|date:"F d, Y \a\t H:i" }}</p>
            </div>

            <!-- Personal Information Section -->
            <div style="margin-bottom: 2rem;">
                <h3 style="color: #333; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #667eea;">
                    <i class="fas fa-user"></i> Personal Information
                </h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-user"></i> Full Name
                        </strong>
                        <span style="color: #666;">{{ form_submission.full_name }}</span>
                    </div>

                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-calendar"></i> Date of Birth
                        </strong>
                        <span style="color: #666;">{{ form_submission.date_of_birth|date:"F d, Y" }}</span>
                    </div>

                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-envelope"></i> Email
                        </strong>
                        <span style="color: #666;">{{ form_submission.email }}</span>
                    </div>

                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-phone"></i> Phone Number
                        </strong>
                        <span style="color: #666;">{{ form_submission.phone_number }}</span>
                    </div>

                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-briefcase"></i> Occupation
                        </strong>
                        <span style="color: #666;">{{ form_submission.occupation }}</span>
                    </div>

                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-history"></i> Previous Applications
                        </strong>
                        <span style="color: #666;">
                            {% if form_submission.previous_applications %}
                                <i class="fas fa-check text-success"></i> Yes
                            {% else %}
                                <i class="fas fa-times text-danger"></i> No
                            {% endif %}
                        </span>
                    </div>
                </div>

                <div style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                        <i class="fas fa-map-marker-alt"></i> Address
                    </strong>
                    <span style="color: #666;">{{ form_submission.address }}</span>
                </div>
            </div>

            <!-- Application Details Section -->
            <div style="margin-bottom: 2rem;">
                <h3 style="color: #333; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #667eea;">
                    <i class="fas fa-clipboard-list"></i> Application Details
                </h3>
                
                <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px; margin-bottom: 1rem;">
                    <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                        <i class="fas fa-bullseye"></i> Purpose of Application
                    </strong>
                    <span style="color: #666;">{{ form_submission.purpose }}</span>
                </div>

                {% if form_submission.additional_notes %}
                <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                        <i class="fas fa-sticky-note"></i> Additional Notes
                    </strong>
                    <span style="color: #666;">{{ form_submission.additional_notes }}</span>
                </div>
                {% endif %}
            </div>

            <!-- Emergency Contact Section -->
            {% if form_submission.emergency_contact_name %}
            <div style="margin-bottom: 2rem;">
                <h3 style="color: #333; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #667eea;">
                    <i class="fas fa-phone-alt"></i> Emergency Contact
                </h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-user-friends"></i> Contact Name
                        </strong>
                        <span style="color: #666;">{{ form_submission.emergency_contact_name }}</span>
                    </div>

                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-phone-alt"></i> Contact Phone
                        </strong>
                        <span style="color: #666;">{{ form_submission.emergency_contact_phone }}</span>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Status and Comments Section -->
            <div style="margin-bottom: 2rem;">
                <h3 style="color: #333; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #667eea;">
                    <i class="fas fa-info-circle"></i> Status Information
                </h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-flag"></i> Current Status
                        </strong>
                        <span class="status-badge status-{{ form_submission.status }}">
                            {{ form_submission.get_status_display }}
                        </span>
                    </div>

                    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                        <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-clock"></i> Last Updated
                        </strong>
                        <span style="color: #666;">{{ form_submission.last_updated|date:"F d, Y H:i" }}</span>
                    </div>
                </div>

                {% if form_submission.comments %}
                <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                        <i class="fas fa-comments"></i> Comments
                    </strong>
                    <span style="color: #666;">{{ form_submission.comments }}</span>
                </div>
                {% endif %}
            </div>

            <!-- Document Section -->
            {% if form_submission.document_file %}
            <div style="margin-bottom: 2rem;">
                <h3 style="color: #333; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #667eea;">
                    <i class="fas fa-paperclip"></i> Attached Documents
                </h3>
                
                <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <strong style="color: #333; display: block; margin-bottom: 0.5rem;">
                        <i class="fas fa-file"></i> Supporting Document
                    </strong>
                    <a href="{{ form_submission.document_file.url }}" target="_blank" class="btn btn-secondary" style="padding: 0.5rem 1rem;">
                        <i class="fas fa-download"></i> Download Document
                    </a>
                </div>
            </div>
            {% endif %}

            <!-- Action Buttons -->
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; padding-top: 2rem; border-top: 1px solid #e9ecef;">
                {% if user.user_type == 'user' %}
                    <a href="{% url 'user_dashboard' %}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </a>
                    {% if form_submission.status == 'completed' %}
                        <a href="{% url 'download_form_pdf' form_submission.form_id %}" class="btn btn-success">
                            <i class="fas fa-download"></i> Download PDF
                        </a>
                    {% endif %}
                {% elif user.user_type == 'csc' %}
                    <a href="{% url 'csc_dashboard' %}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </a>
                    <a href="{% url 'edit_form' form_submission.form_id %}" class="btn btn-warning">
                        <i class="fas fa-edit"></i> Edit Form
                    </a>
                    {% if form_submission.status != 'completed' %}
                        <a href="{% url 'submit_form' form_submission.form_id %}" 
                           onclick="return confirmAction('Are you sure you want to mark this form as completed?')"
                           class="btn btn-success">
                            <i class="fas fa-check"></i> Mark Complete
                        </a>
                    {% endif %}
                {% endif %}
            </div>

            <!-- Form Metadata -->
            <div style="margin-top: 2rem; padding: 1rem; background: #f8f9fa; border-radius: 8px; font-size: 0.875rem; color: #666;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                    <div>
                        <strong>Form ID:</strong><br>
                        #{{ form_submission.form_id }}
                    </div>
                    <div>
                        <strong>Submitted by:</strong><br>
                        {{ form_submission.user.username }}
                    </div>
                    <div>
                        <strong>Submission Date:</strong><br>
                        {{ form_submission.submission_date|date:"F d, Y H:i" }}
                    </div>
                    <div>
                        <strong>Last Update:</strong><br>
                        {{ form_submission.last_updated|date:"F d, Y H:i" }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}